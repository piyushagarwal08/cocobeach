var ERE_POPUP=ERE_POPUP||{};!function(a){ERE_POPUP={init:function(){a("select#ere-shortcodes").chosen(),this.insert_shortcode(),this.select_shortcode()},required_element:function(){var b=a("#options-"+a("#ere-shortcodes").val());a("[data-required-element]",b).each(function(){var c=a(this),d=c.attr("data-required-element"),e=a('[name="'+d+'"]',b),f=function(c,d,e){a('[data-required-element="'+c+'"]',b).each(function(){var b=a(this).closest(".option-item-wrap"),c=a(this).attr("data-required-value");"checkbox"==e?(d.is(":checked")&&"true"===c||!d.is(":checked")&&"false"===c)&&"none"!=d.closest(".option-item-wrap").css("display")?b.show():b.hide():-1!==c.indexOf(d.val())&&"none"!=d.closest(".option-item-wrap").css("display")?b.show():b.hide()}),setTimeout(g,100)},g=function(){a(".two-option-wrap",b).each(function(){var b=!1;a(".option-item-wrap",a(this)).each(function(){"none"!=a(this).css("display")&&(b=!0)}),b?a(this).show():a(this).hide()})};setTimeout(function(){e.each(function(){var b=a(this),c=b.is("input:checkbox")?"checkbox":"select-one";f(d,b,c)})},100),e.off("change").on("change",function(b){b.preventDefault();var c=a(this);f(d,c,b.target.type)})})},update_shortcode:function(){var b=a("#ere-shortcodes").val(),c="["+b;a("#options-"+b+" input[type=checkbox]").each(function(){a(this).is(":checked")&&"none"!=a(this).closest(".option-item-wrap").css("display")&&(c+=" "+a(this).attr("name")+'="true"')}),a("#options-"+b+' select:not("[multiple=multiple]")').each(function(){"none"!=a(this).closest(".option-item-wrap").css("display")&&(c+=" "+a(this).attr("id")+'="'+a(this).val()+'"')}),a("#options-"+b+" select[multiple=multiple]").each(function(){if("none"!=a(this).closest(".option-item-wrap").css("display")){var b=null!=a(this).val()&&a(this).val().length>0?a(this).val():"";c+=" "+a(this).attr("id")+'="'+b+'"'}}),a("#options-"+b+" [data-name=image-upload] input#options-item-id").each(function(){"none"!=a(this).closest(".option-item-wrap").css("display")&&(c+=" "+a(this).attr("name")+'="'+a(this).attr("value")+'"')}),a("#options-"+b+" input[type=text]").each(function(){"none"!=a(this).closest(".option-item-wrap").css("display")&&void 0!==a(this).attr("name")&&(c+=" "+a(this).attr("name")+'="'+a(this).val()+'"')}),c+="]",window.wp.media.editor.insert(c),a.magnificPopup.close()},insert_shortcode:function(){a("#insert-shortcode").on("click",function(){return ERE_POPUP.update_shortcode(),!1})},select_shortcode:function(){a("#ere-shortcodes").on("change",function(){ERE_POPUP.required_element();var b=a(this).val(),c=a("#options-"+b);c.attr("data-type");a(".shortcode-options").hide(),c.show(),ERE_POPUP.reset_fileds()})},reset_fileds:function(){var b=a("#ere-input-shortcode"),c=b.find("#ere-shortcodes").val(),d=a("#options-"+c);d.find(".ere-selectize-input").selectize({plugins:["remove_button"],delimiter:",",persist:!1,create:function(a){return{value:a,text:a}}}),d.find("input:text, input:password, input:file, textarea").each(function(){var b=a(this),c=b.attr("data-default-value");void 0!==c?(b.attr("value",c),b.val(c)):(b.attr("value",""),b.val(""))}),d.find('[multiple="multiple"]').val(""),d.find('select:not("#ere-shortcodes, [multiple=multiple]")').each(function(){var b=a(this),c=b.attr("data-default-value");b.prop("selectedIndex",0),void 0!==c?(b.find('option[value="'+c+'"]').attr("selected","selected"),b.val(c)):b.find("option:first-child").attr("selected","selected")}),d.find("input:checkbox").each(function(){var b=a(this),c=b.attr("data-default-value");void 0!==c&&"true"==c?b.attr("checked","checked"):b.removeAttr("checked")}),d.find(".shortcode-options").each(function(){a(this).find(".shortcode-dynamic-item").addClass("marked-for-removal"),a(this).find(".shortcode-dynamic-item:first").removeClass("marked-for-removal"),a(this).find(".shortcode-dynamic-item.marked-for-removal").remove()}),d.find("#options-item-id").each(function(){a(this).val(""),a(this).attr("value","")}),d.find(".ere-image-screenshot").attr("src",""),d.find(".ere-image-upload-remove").hide(),d.find(".ere-image-upload").show(),d.find(".ere-selectize-input").each(function(){a(this)[0].selectize&&(a(this)[0].selectize.destroy(),a(this).val("")),a(this).selectize({plugins:["remove_button"],delimiter:",",persist:!1,create:function(a){return{value:a,text:a}}})})}},a(document).ready(function(){ERE_POPUP.init()})}(jQuery);