var ERE_Compare=ERE_Compare||{};!function($){"use strict";if("undefined"!=typeof ere_compare_vars)var ajax_url=ere_compare_vars.ajax_url,compare_button_url=ere_compare_vars.compare_button_url,alert_title=ere_compare_vars.alert_title,alert_message=ere_compare_vars.alert_message,alert_not_found=ere_compare_vars.alert_not_found,compare_listings=$("#compare-listings"),item=$(".compare-property","#compare-properties-listings").length;ERE_Compare={init:function(){this.register_event_compare(),this.compare_property(),this.open_compare(),this.close_compare(),this.compare_listing()},register_event_compare:function(){$("a.compare-property").on("click",function(e){if(!$(this).hasClass("on-handle")){e.preventDefault();var $this=$(this).addClass("on-handle"),property_inner=$this.closest(".property-inner").addClass("property-active-hover"),property_id=$this.data("property-id");$(".listing-btn").removeClass("hidden"),4==item?$this.children().hasClass("plus")?(item--,$this.find("i.fa-minus").removeClass("fa-minus").addClass("fa-spinner fa-spin")):ERE.popup_alert("fa fa-check-squaere-o",alert_title,alert_message):$this.children().hasClass("plus")?(item--,$this.find("i.fa-minus").removeClass("fa-minus").addClass("fa-spinner fa-spin")):(item++,$this.find("i.fa-plus").removeClass("fa-plus").addClass("fa-spinner fa-spin minus")),$.ajax({url:ajax_url,method:"post",data:{action:"ere_compare_add_remove_property_ajax",property_id:property_id},success:function(a){$this.children().hasClass("minus")?$this.find("i.minus").removeClass("fa-spinner fa-spin minus").addClass("fa-minus plus"):$this.find("i.fa-spinner").removeClass("fa-spinner fa-spin plus").addClass("fa-plus"),$("div#compare-properties-listings").replaceWith(a),ERE_Compare.compare_listing(),0==item?($(".listing-btn").addClass("hidden"),ERE_Compare.close_compare()):ERE_Compare.open_compare(),$this.removeClass("on-handle"),property_inner.removeClass("property-active-hover")},error:function(xhr){var err=eval("("+xhr.responseText+")");console.log(err.Message)}})}})},compare_listing:function(){$(".listing-btn").off("click").on("click",function(){compare_listings.hasClass("listing-open")?(compare_listings.removeClass("listing-open"),$(".listing-btn").find("i.fa-angle-right").removeClass("fa-angle-right").addClass("fa-angle-left")):(compare_listings.addClass("listing-open"),$(".listing-btn").find("i.fa-angle-left").removeClass("fa-angle-left").addClass("fa-angle-right"))})},open_compare:function(){compare_listings.addClass("listing-open"),$(".listing-btn").find("i.fa-angle-left").removeClass("fa-angle-left").addClass("fa-angle-right")},close_compare:function(){compare_listings.hasClass("listing-open")&&(compare_listings.removeClass("listing-open"),$(".listing-btn").find("i.fa-angle-right").removeClass("fa-angle-right").addClass("fa-angle-left"))},compare_property:function(){if(1==compare_listings.length&&($("div.compare-property").each(function(){var a=$(this).attr("data-property-id"),b=$("a[data-property-id='"+a+"']");$("i.fa-plus",b).removeClass("fa-plus").addClass("fa-minus plus")}),ERE_Compare.compare_listing(),$(".compare-property").length>0)){var handle=!0;ERE_Compare.register_event_compare(item);var $handle=!0;$(document).on("click","#compare-properties-listings .compare-property-remove",function(e){if(e.preventDefault(),$handle){$handle=!1;var $this=$(this),property_id=$this.parent().attr("data-property-id"),property=$("a[data-property-id='"+property_id+"']");$this.parent().addClass("remove"),$("i.plus",property).removeClass("fa-minus plus").addClass("fa-plus"),item--,0==item&&($("#compare-properties-listings").addClass("hidden"),$(".listing-btn").addClass("hidden"),ERE_Compare.close_compare()),$.ajax({url:ajax_url,method:"post",data:{action:"ere_compare_add_remove_property_ajax",property_id:property_id},success:function(a){$("div#compare-properties-listings").replaceWith(a),ERE_Compare.compare_listing(),0==item?($(".listing-btn").addClass("hidden"),ERE_Compare.close_compare()):ERE_Compare.open_compare(),$handle=!0},error:function(xhr){var err=eval("("+xhr.responseText+")");console.log(err.Message),$handle=!0}})}}),$(document).on("click",".compare-properties-button",function(){return""!=compare_button_url?window.location.href=compare_button_url:alert(alert_not_found),!1})}}},$(document).ready(function(a){ERE_Compare.init()})}(jQuery);