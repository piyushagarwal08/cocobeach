!function(e){"use strict";e(document).ready(function(e){if("undefined"!=typeof ere_property_vars){var r=ere_property_vars.ajax_url,o=ere_property_vars.googlemap_zoom_level,t=ere_property_vars.upload_nonce,a=ere_property_vars.fileTypeTitle,i=(ere_property_vars.msg_digits,ere_property_vars.max_property_images),l=ere_property_vars.image_max_file_size,s=ere_property_vars.floor_name_text,n=ere_property_vars.floor_size_text,p=ere_property_vars.floor_size_postfix_text,_=ere_property_vars.floor_bedrooms_text,d=ere_property_vars.floor_bathrooms_text,f=ere_property_vars.floor_price_text,c=ere_property_vars.floor_price_postfix_text,m=ere_property_vars.floor_image_text,u=ere_property_vars.floor_description_text,v=ere_property_vars.floor_upload_text,y=ere_property_vars.property_title,g=ere_property_vars.property_price,h=ere_property_vars.property_type,b=(ere_property_vars.property_status,ere_property_vars.property_labels),x=ere_property_vars.property_price_postfix,j=ere_property_vars.property_bedrooms,w=ere_property_vars.property_bathrooms,z=ere_property_vars.property_size,k=ere_property_vars.property_land,q=ere_property_vars.property_garage,E=ere_property_vars.property_year,I=ere_property_vars.property_address,T=ere_property_vars.ere_metabox_prefix,U=function(e){return 1==e};e("#submit_property_form").validate({ignore:":not(select:hidden, input:visible, textarea:visible)",rules:{property_title:{required:U(y)},property_price:{required:U(g),number:!0},property_type:{required:U(h)},property_labels:{required:U(b)},property_price_postfix:{required:U(x)},property_size:{required:U(z),number:!0},property_land:{required:U(k),number:!0},property_bedrooms:{required:U(j),number:!0},property_bathrooms:{required:U(w),number:!0},property_garage:{required:U(q),number:!0},property_year:{required:U(E),number:!0},property_map_address:{required:U(I)}},messages:{property_title:"",property_des:"",property_price:"",property_bedrooms:"",property_bathrooms:"",property_size:"",property_map_address:"",property_type:"",property_labels:"",property_price_postfix:"",property_land:"",property_garage:"",property_year:""}});var O=function(){e('input[name="property_form"]').val();e("#geocomplete").geocomplete({map:".map_canvas",details:"form",types:["geocode","establishment"],mapOptions:{zoom:parseInt(o)},markerOptions:{draggable:!0}}).one("geocode:result",function(){}),e("#geocomplete").bind("geocode:dragged",function(r,o){e("input[name=lat]").val(o.lat()),e("input[name=lng]").val(o.lng()),e("#reset").show()}),e("#reset").on("click",function(){return e("#geocomplete").geocomplete("resetMarker"),e("#reset").hide(),!1}),e("#find").on("click",function(r){r.preventDefault(),e("#geocomplete").trigger("geocode")})};O(),e("input[name='agent_display_option']").on("change",function(){e("select[name='property_agent']").hide(),"other_info"==e(this).val()?e("#property_other_contact").slideDown("slow"):e("#property_other_contact").slideUp("slow")});var D=function(){var r=0;e("tr","#ere_additional_details").each(function(){var o=e('input[name*="additional_feature_title"]',e(this)),t=e('input[name*="additional_feature_value"]',e(this));o.attr("name","additional_feature_title["+r+"]"),o.attr("id","additional_feature_title_"+r),t.attr("name","additional_feature_value["+r+"]"),t.attr("id","additional_feature_value_"+r),r++})};e("#ere_additional_details").sortable({revert:100,placeholder:"detail-placeholder",handle:".sort-additional-row",cursor:"move",stop:function(e,r){D()}}),e(".add-additional-feature").on("click",function(r){r.preventDefault();var o=e(this).data("increment")+1;e(this).data("increment",o),e(this).attr({"data-increment":o});var t='<tr><td class="action-field"><span class="sort-additional-row"><i class="fa fa-navicon"></i></span></td><td><input class="form-control" type="text" name="additional_feature_title['+o+']" id="additional_feature_title_'+o+'" value=""></td><td><input class="form-control" type="text" name="additional_feature_value['+o+']" id="additional_feature_value_'+o+'" value=""></td><td><span data-remove="'+o+'" class="remove-additional-feature"><i class="fa fa-remove"></i></span></td></tr>';e("#ere_additional_details").append(t),C()});var C=function(){e(".remove-additional-feature").on("click",function(r){r.preventDefault();var o=e(this),t=o.closest(".additional-block"),a=t.find(".add-additional-feature"),i=parseInt(a.data("increment"))-1;o.closest("tr").remove(),a.data("increment",i),a.attr("data-increment",i),D()})};C();var M=function(){var r=0;e("tr","#ere_floors").each(function(){var o=e('label[for*="'+T+'floor_name_"]',e(this)),t=e('input[name*="'+T+'floor_name"]',e(this)),a=e('label[for*="'+T+'floor_price_"]',e(this)),i=e('input[name*="'+T+'floor_price"]',e(this)),l=e('label[for*="'+T+'floor_price_postfix_"]',e(this)),s=e('input[name*="'+T+'floor_price_postfix"]',e(this)),n=e('label[for*="'+T+'floor_size_"]',e(this)),p=e('input[name*="'+T+'floor_size"]',e(this)),_=e('label[for*="'+T+'floor_size_postfix_"]',e(this)),d=e('input[name*="'+T+'floor_size_postfix"]',e(this)),f=e('label[for*="'+T+'floor_bedrooms_"]',e(this)),c=e('input[name*="'+T+'floor_bedrooms"]',e(this)),m=e('label[for*="'+T+'floor_bathrooms_"]',e(this)),u=e('input[name*="'+T+'floor_bedrooms"]',e(this)),v=e('label[for*="'+T+'floor_image_url_"]',e(this)),y=e('input[id*="'+T+'floor_image_url"]',e(this)),g=e('input[id*="'+T+'floor_image_id"]',e(this)),h=e('button[class*="ere_floorsImg"]',e(this)),b=e('label[for*="'+T+'floor_description_"]',e(this)),x=e('input[id*="'+T+'floor_description"]',e(this));o.attr("for",T+"floor_name_"+r),t.attr("name",T+"floors["+r+"]["+T+"floor_name]"),t.attr("id",T+"floor_name_"+r),a.attr("for",T+"floor_price_"+r),i.attr("name",T+"floors["+r+"]["+T+"floor_price]"),i.attr("id",T+"floor_price_"+r),l.attr("for",T+"floor_price_postfix_"+r),s.attr("name",T+"floors["+r+"]["+T+"floor_price_postfix]"),s.attr("id",T+"floor_price_postfix_"+r),n.attr("for",T+"floor_size_"+r),p.attr("name",T+"floors["+r+"]["+T+"floor_size]"),p.attr("id",T+"floor_size_"+r),_.attr("for",T+"floor_size_postfix_"+r),d.attr("name",T+"floors["+r+"]["+T+"floor_size_postfix]"),d.attr("id",T+"floor_size_postfix_"+r),f.attr("for",T+"floor_bedrooms_"+r),c.attr("name",T+"floors["+r+"]["+T+"floor_bedrooms]"),c.attr("id",T+"floor_bedrooms_"+r),m.attr("for",T+"floor_bathrooms_"+r),u.attr("name",T+"floors["+r+"]["+T+"floor_bathrooms]"),u.attr("id",T+"floor_bathrooms_"+r),v.attr("for",T+"floor_image_url_"+r),y.attr("name",T+"floors["+r+"]["+T+"floor_image][url]"),y.attr("id",T+"floor_image_url_"+r),g.attr("name",T+"floors["+r+"]["+T+"floor_image][id]"),g.attr("id",T+"floor_image_id_"+r),h.attr("id",r),b.attr("for",T+"floor_description_"+r),x.attr("name",T+"floors["+r+"]["+T+"floor_description]"),x.attr("id",T+"floor_description_"+r),r++})};e("#ere_floors").sortable({revert:100,placeholder:"detail-placeholder",handle:".sort-floors-row",cursor:"move",stop:function(e,r){M()}}),e("#add-floors-row").on("click",function(r){r.preventDefault();var o=e(this).data("increment")+1;e(this).data("increment",o),e(this).attr({"data-increment":o});var t='<tr><td class="row-sort"><span class="sort sort-floors-row"><i class="fa fa-navicon"></i></span></td><td class="sort-middle"><div class="sort-inner-block"><div class="row"><div class="col-sm-12"><div class="form-group"><label for="'+T+"floor_name_"+o+'">'+s+'</label><input name="'+T+"floors["+o+"]["+T+'floor_name]" type="text" id="'+T+"floor_name_"+o+'" class="form-control"></div></div><div class="col-sm-6"><div class="form-group"><label for="'+T+"floor_price_"+o+'">'+f+'</label><input name="'+T+"floors["+o+"]["+T+'floor_price]" type="text" id="'+T+"floor_price_"+o+'" class="form-control"></div></div><div class="col-sm-6"><div class="form-group"><label for="'+T+"floor_price_postfix_"+o+'">'+c+'</label><input name="'+T+"floors["+o+"]["+T+'floor_price_postfix]" type="text" id="'+T+"floor_price_postfix_"+o+'" class="form-control"></div></div><div class="col-sm-6"><div class="form-group"><label for="'+T+"floor_size_"+o+'">'+n+'</label><input name="'+T+"floors["+o+"]["+T+'floor_size]" type="text" id="'+T+"floor_size_"+o+'" class="form-control"></div></div><div class="col-sm-6"><div class="form-group"><label for="'+T+"floor_size_postfix_"+o+'">'+p+'</label><input name="'+T+"floors["+o+"]["+T+'floor_size_postfix]" type="text" id="'+T+"floor_size_postfix_"+o+'" class="form-control"></div></div><div class="col-sm-6"><div class="form-group"><label for="'+T+"floor_bedrooms_"+o+'">'+_+'</label><input name="'+T+"floors["+o+"]["+T+'floor_bedrooms]" type="text" id="'+T+"floor_bedrooms_"+o+'" class="form-control"></div></div><div class="col-sm-6"><div class="form-group"><label for="'+T+"floor_bathrooms_"+o+'">'+d+'</label><input name="'+T+"floors["+o+"]["+T+'floor_bathrooms]" type="text" id="'+T+"floor_bathrooms_"+o+'" class="form-control"></div></div><div class="col-sm-6"><div class="form-group"><label for="'+T+"floor_image_url_"+o+'">'+m+'</label><div id="ere-floor-plupload-container" class="file-upload-block"><input name="'+T+"floors["+o+"]["+T+'floor_image][url]" type="text" id="'+T+"floor_image_url_"+o+'" class="ere_floor_image_url form-control"><input name="'+T+"floors["+o+"]["+T+'floor_image][id]" type="hidden" id="'+T+"floor_image_id_"+o+'" class="ere_floor_image_id"><button id="'+o+'" style="position: absolute" title="'+v+'" class="ere_floorsImg"><i class="fa fa-file-image-o"></i></button></div><div id="ere-floor-errors-log"></div></div></div><div class="col-sm-6"><div class="form-group"><label for="'+T+"floor_description_"+o+'">'+u+'</label><textarea name="'+T+"floors["+o+"]["+T+'floor_description]" rows="4" id="'+T+"floor_description_"+o+'" class="form-control"></textarea></div></div></div></div></td><td class="row-remove"><span data-remove="'+o+'" class="remove-floors-row remove"><i class="fa fa-remove"></i></span></td></tr>';e("#ere_floors").append(t),B(),N()});var B=function(){e(".remove-floors-row").on("click",function(r){r.preventDefault();var o=e(this),t=o.closest(".add-sort-table"),a=t.find("#add-floors-row"),i=parseInt(a.data("increment"))-1;o.closest("tr").remove(),a.data("increment",i),a.attr("data-increment",i),M()})};B();var F=function(){var r=e('[name="floors_enable"][checked]',".property-floors-control"),o=r.val(),t=r.closest(".property-floors-control").next(".property-floors-data");1==o?t.slideDown("slow"):0==o&&t.slideUp("slow"),e('input[name="floors_enable"]',".property-floors-control").each(function(){e(this).on("click",function(){o=e(this).val(),1==o?t.slideDown("slow"):0==o&&t.slideUp("slow")})})};F();var H=function(){e(".icon-featured",".property-media").on("click",function(){var r=e(this),o=r.data("attachment-id"),t=r.find("i");e(".gallery-thumb .featured_image_id").remove(),e(".gallery-thumb .icon-featured i").removeClass("fa-star").addClass("fa-star-o"),r.closest(".gallery-thumb").append('<input type="hidden" class="featured_image_id" name="featured_image_id" value="'+o+'">'),t.removeClass("fa-star-o").addClass("fa-star")}),e(".icon-delete",".property-media").on("click",function(){var o=e(this),a=o.children("i"),i=o.closest(".property-thumb"),l=o.data("property-id"),s=o.data("attachment-id");a.addClass("fa-spinner fa-spin"),e.ajax({type:"post",url:r,dataType:"json",data:{action:"ere_remove_property_thumbnail_ajax",property_id:l,thumbnail_id:s,removeNonce:t},success:function(e){e.success&&(i.remove(),i.hide()),a.removeClass("fa-spinner fa-spin")},error:function(){a.removeClass("fa-spinner fa-spin")}})})};H();var L=function(){e("#property-thumbs-container").sortable();var o=new plupload.Uploader({browse_button:"select-images",file_data_name:"property_upload_file",container:"ere-gallery-plupload-container",drop_element:"ere-gallery-plupload-container",multi_selection:!0,url:r+"?action=ere_property_img_upload_ajax&nonce="+t,filters:{mime_types:[{title:a,extensions:"jpg,jpeg,gif,png"}],max_file_size:l,prevent_duplicates:!0}});o.init(),o.bind("FilesAdded",function(e,r){var t="",a=i;return e.files.length>a?(e.splice(a),void alert("no more than "+a+" file(s)")):(plupload.each(r,function(e){t+='<div id="holder-'+e.id+'" class="col-sm-2 property-thumb"></div>'}),document.getElementById("property-thumbs-container").innerHTML+=t,e.refresh(),void o.start())}),o.bind("UploadProgress",function(e,r){document.getElementById("holder-"+r.id).innerHTML='<span><i class="fa fa-spinner fa-spin"></i></span>'}),o.bind("Error",function(e,r){document.getElementById("ere-gallery-errors-log").innerHTML+="<br/>Error #"+r.code+": "+r.message}),o.bind("FileUploaded",function(r,o,t){var a=e.parseJSON(t.response);if(a.success){var i='<figure class="gallery-thumb"><img src="'+a.url+'" alt="" /><div class="gallery-item-actions"><a class="icon icon-delete" data-property-id="0"  data-attachment-id="'+a.attachment_id+'" href="javascript:;" ><i class="fa fa-trash-o"></i></a><a class="icon icon-featured" data-property-id="0"  data-attachment-id="'+a.attachment_id+'" href="javascript:;" ><i class="fa fa-star-o"></i></a><input type="hidden" class="property_image_ids" name="property_image_ids[]" value="'+a.attachment_id+'"/><span style="display: none;" class="icon icon-loader"><i class="fa fa-spinner fa-spin"></i></span></div></figure>';document.getElementById("holder-"+o.id).innerHTML=i,H()}})};L();var S=function(){var o=new plupload.Uploader({browse_button:"select-images-360",file_data_name:"property_upload_file",container:"ere-image-360-plupload-container",url:r+"?action=ere_property_img_upload_ajax&nonce="+t,filters:{mime_types:[{title:a,extensions:"jpg,jpeg,gif,png"}],max_file_size:l,prevent_duplicates:!0}});o.init(),o.bind("FilesAdded",function(e,r){var t=i;return e.files.length>t?(e.splice(t),void alert("no more than "+t+" file(s)")):(plupload.each(r,function(e){}),e.refresh(),void o.start())}),o.bind("Error",function(e,r){document.getElementById("ere-image-360-errors-log").innerHTML+="<br/>Error #"+r.code+": "+r.message}),o.bind("FileUploaded",function(r,o,t){var a=e.parseJSON(t.response);if(a.success){e(".ere_image_360_url").val(a.full_image),e(".ere_image_360_id").val(a.attachment_id);var i=e("#ere-property-image-360-view").attr("data-plugin-url"),l='<iframe width="100%" height="200" scrolling="no" allowfullscreen src="'+i+"public/assets/packages/vr-view/index.html?image="+a.full_image+'"></iframe>';e("#ere-property-image-360-view").html(l)}})};S();var N=function(){var o=new plupload.Uploader({browse_button:"0",file_data_name:"property_upload_file",container:"ere-floor-plupload-container",url:r+"?action=ere_property_img_upload_ajax&nonce="+t,filters:{mime_types:[{title:a,extensions:"jpg,jpeg,gif,png"}],max_file_size:l,prevent_duplicates:!0}});o.init(),o.bind("FilesAdded",function(e,r){var t=i;return e.files.length>t?(e.splice(t),void alert("no more than "+t+" file(s)")):(plupload.each(r,function(e){}),e.refresh(),void o.start())}),o.bind("Error",function(e,r){document.getElementById("ere-floor-errors-log").innerHTML+="<br/>Error #"+r.code+": "+r.message});var s;o.bind("FileUploaded",function(r,o,t){var a=e.parseJSON(t.response);a.success&&(e("#"+s).parents("tr").find(".ere_floor_image_url").val(a.full_image),e("#"+s).parents("tr").find(".ere_floor_image_id").val(a.attachment_id))}),e(".ere_floorsImg").mouseenter(function(){s=e(this).attr("id"),o.setOption("browse_button",e(this).attr("id")),o.refresh()})};N();var P=function(){if(e(".ere-property-country-ajax").length){var o=e(".ere-property-country-ajax").val();""!=o&&e.ajax({type:"POST",url:r,data:{action:"ere_get_states_by_country_ajax",country:o,type:0},success:function(r){e(".ere-property-state-ajax").html(r);var o=e(".ere-property-state-ajax").attr("data-selected");"undefined"!=o&&e(".ere-property-state-ajax").val(o)}})}};P(),e(".ere-property-country-ajax").on("change",function(){P()});var A=function(){if(e(".ere-property-state-ajax").length){var o=e(".ere-property-state-ajax").val();""!=o&&e.ajax({type:"POST",url:r,data:{action:"ere_get_cities_by_state_ajax",state:o,type:0},success:function(r){e(".ere-property-city-ajax").html(r);var o=e(".ere-property-city-ajax").attr("data-selected");"undefined"!=o&&e(".ere-property-city-ajax").val(o)}})}};A(),e(".ere-property-state-ajax").on("change",function(){A()});var J=function(){if(e(".ere-property-city-ajax").length){var o=e(".ere-property-city-ajax").val();""!=o&&e.ajax({type:"POST",url:r,data:{action:"ere_get_neighborhoods_by_city_ajax",city:o,type:0},success:function(r){e(".ere-property-neighborhood-ajax").html(r);var o=e(".ere-property-neighborhood-ajax").attr("data-selected");"undefined"!=o&&e(".ere-property-neighborhood-ajax").val(o)}})}};J(),e(".ere-property-city-ajax").on("change",function(){J()})}}),e(window).load(function(){e("#geocomplete").trigger("geocode")})}(jQuery);