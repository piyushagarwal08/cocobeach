jQuery(document).ready(function($){"use strict";function ere_execute_url_search(){$("#search-btn",".search-properties-form").on("click",function(e){e.preventDefault();var t=$(this).closest(".search-properties-form"),r=t.data("href"),a=[],i="?",n=$('[name="advanced"]').attr("value");if(-1!==r.indexOf("?")&&(i="&"),$(".search-field",t).each(function(){var e=$(this),t=e.attr("name"),r=e.val(),i=e.data("default-value");1==e.closest(".search-advanced-info").length&&"1"!=n||r!=i&&(a[t]=r)}),$(".ere-sliderbar-filter",t).each(function(){var e=$(this),t=e.find(".min-input-request").attr("name"),r=e.find(".max-input-request").attr("name"),i=e.find(".min-input-request").val(),s=e.find(".max-input-request").val(),o=e.data("min-default"),l=e.data("max-default");1==e.closest(".search-advanced-info").length&&"1"!=n||i==o&&s==l||(a[t]=i,a[r]=s)}),void 0!==a["featured-search"]){var s="";$('[name="other_feature"]',t).each(function(){var e=$(this),t=e.attr("value");e.is(":checked")&&(s+=t+";")}),""!==s&&(s=s.substring("0",s.length-1),a.other_feature=s)}if(a!==[])for(var o in a)a.hasOwnProperty(o)&&(i+=o+"="+a[o]+"&");i=i.substring("0",i.length-1),window.location.href=r+i})}function ere_check_scroll_result_by_title(){var e=$("ul.listing-item-by-name");e.height()>244?e.css("overflow-y","scroll"):e.css("overflow-y","auto")}function ere_full_screen(){if($(".ere-search-properties.style-vertical").length>0){var e=$(window).outerHeight(),t=$("#wpadminbar").outerHeight();null==t&&(t=0);var r=e-t-$("header").outerHeight()-$("footer").outerHeight()-$(".wpadminbar").outerHeight();$(".ere-search-properties.style-vertical .ere-map-search").css("height",r),$(".ere-search-properties.style-vertical .ere-map-search .ere-map-result").css("height",r),$(".col-scroll-vertical").css({height:r,"overflow-y":"scroll","overflow-x":"hidden"});var a=$(".owl-carousel",".list-property-result-ajax"),i=$(".property-item",a);a.trigger("destroy.owl.carousel"),a.css("opacity",1),a.imagesLoaded(function(){ERE.set_item_effect(i,"hide"),ERE_Carousel.owlCarousel(),i=$(".property-item",a),ERE.set_item_effect(i,"show")})}}function ere_set_slider_filter(e){var t,r,a=e,i=parseInt(a.attr("data-min-default")),n=parseInt(a.attr("data-max-default")),s=a.attr("data-min"),o=a.attr("data-max");a.find(".sidebar-filter").slider({min:i,max:n,range:!0,values:[s,o],slide:function(e,i){t=i.values[0],r=i.values[1],a.attr("data-min",t),a.attr("data-max",r),a.find("input.min-input-request").attr("value",t),a.find("input.max-input-request").attr("value",r),a.find("span").hasClass("not-format")?(a.find("span.min-value").html(t),a.find("span.max-value").html(r)):(a.find("span.min-value:not(.not-format)").html(ERE.number_format(t)),a.find("span.max-value:not(.not-format)").html(ERE.number_format(r)))},stop:function(e,t){var r=$(e.target).parents("div.ere-search-properties").find(".ere-map-result").attr("id");if($("#"+r).length>0){var a=$(this).parents(".search-properties-form");ere_search_on_change(a,r)}}})}function ere_register_slider_filter(){$(".ere-sliderbar-filter").each(function(){ere_set_slider_filter($(this))})}function ere_set_slider_value(){$(".ere-sliderbar-filter").each(function(){var e=$(this),t=e.attr("data-min-default"),r=e.attr("data-max-default"),a=e.attr("data-min"),i=e.attr("data-max"),n=(a-t)/(r-t)*100+"%",s=(i-a)/(r-t)*100+"%",o=(i-t)/(r-t)*100+"%";e.find(".ui-slider-range.ui-corner-all.ui-widget-header").css({left:n,width:s}),e.find(".ui-slider-handle.ui-corner-all.ui-state-default").css("left",n),e.find(".ui-slider-handle.ui-corner-all.ui-state-default:last-child").css("left",o)})}var ajax_url=ere_search_vars.ajax_url,ere_get_states_by_country=function(){if($(".ere-property-country-ajax").length){var e=$(".ere-property-country-ajax").val();""!=e&&$.ajax({type:"POST",url:ajax_url,data:{action:"ere_get_states_by_country_ajax",country:e,type:1},success:function(e){$(".ere-property-state-ajax").html(e);var t=$(".ere-property-state-ajax").attr("data-selected");"undefined"!=t&&$(".ere-property-state-ajax").val(t)}})}};ere_get_states_by_country(),$(".ere-property-country-ajax").on("change",function(){ere_get_states_by_country()});var ere_get_cities_by_state=function(){if($(".ere-property-state-ajax").length){var e=$(".ere-property-state-ajax").val();""!=e&&$.ajax({type:"POST",url:ajax_url,data:{action:"ere_get_cities_by_state_ajax",state:e,type:1},success:function(e){$(".ere-property-city-ajax").html(e);var t=$(".ere-property-city-ajax").attr("data-selected");"undefined"!=t&&$(".ere-property-city-ajax").val(t)}})}};ere_get_cities_by_state(),$(".ere-property-state-ajax").on("change",function(){ere_get_cities_by_state()});var ere_get_neighborhoods_by_city=function(){if($(".ere-property-city-ajax").length){var e=$(".ere-property-city-ajax").val();""!=e&&$.ajax({type:"POST",url:ajax_url,data:{action:"ere_get_neighborhoods_by_city_ajax",city:e,type:1},success:function(e){$(".ere-property-neighborhood-ajax").html(e);var t=$(".ere-property-neighborhood-ajax").attr("data-selected");"undefined"!=t&&$(".ere-property-neighborhood-ajax").val(t)}})}};if(ere_get_neighborhoods_by_city(),$(".ere-property-city-ajax").on("change",function(){ere_get_neighborhoods_by_city()}),$(window).resize(function(){ere_full_screen()}),$(window).on("orientationchange",function(){ere_full_screen()}),ere_execute_url_search(),ere_full_screen(),$(".ere-sliderbar-filter.ere-sliderbar-price").on("register.again",function(){$(".ere-sliderbar-filter.ere-sliderbar-price").each(function(){ere_set_slider_filter($(this))}),$(".ere-sliderbar-filter.ere-sliderbar-area").each(function(){ere_set_slider_filter($(this))})}),ere_register_slider_filter(),ere_set_slider_value(),$(".search-properties-form .advanced-search-button").each(function(){var e=$(this);e.on("click",function(t){var r=$(this),a=r.parents("div.ere-search-properties").find(".ere-map-result").attr("id"),i="#"+a,n=r.parent().parent().parent(),s=e.find('input[name="advanced"]'),o=s.attr("value");if(n.find(".search-advanced-info").slideToggle(),"0"==o?s.attr("value","1"):s.attr("value","0"),$(i).length>0){var l=$(this).parents(".search-properties-form");ere_search_on_change(l,a)}})}),$(".other-featured .enable-featured .button-other-featured").each(function(){$(this).on("click",function(e){e.preventDefault();var t=$(this),r=t.parents("div.ere-search-properties").find(".ere-map-result").attr("id"),a="#"+r,i=t.parent(),n=t.parent().parent(),s=$('input[name="featured-search"]',i);if(n.find(".featured-list").slideToggle(),t.toggleClass("show"),1==t.hasClass("show")?(t.find(".hide-featured-text").removeClass("hide"),t.find(".show-featured-text").addClass("hide"),s.attr("value","1")):(t.find(".hide-featured-text").addClass("hide"),t.find(".show-featured-text").removeClass("hide"),s.attr("value","0")),$(a).length>0){var o=$(this).parents(".search-properties-form");ere_search_on_change(o,r)}})}),"undefined"!=typeof ere_search_vars){var keyword_auto_complete=ere_search_vars.keyword_auto_complete,ere_auto_complete=function(){var e=$.parseJSON(keyword_auto_complete);$('input[name="keyword"]').autocomplete({source:e,delay:300,minLength:1,change:function(){var e=$(this).parents("div.ere-search-properties").find(".ere-map-result").attr("id");if($("#"+e).length>0){var t=$(this).parents(".search-properties-form");ere_search_on_change(t,e)}}}).autocomplete("option","change")};ere_auto_complete();var ere_title_auto_complete=function(){var count_prop=0,auto_complete_container=$(".ere-result-by-title");$('input[name="title"]').keyup(function(){var $this=$(this),ere_result_by_title=$this.parents().find(".ere-result-by-title");$(this).val().length>=2?(ere_result_by_title.fadeIn(),$.ajax({type:"POST",url:ajax_url,data:{action:"ere_title_auto_complete_search",title:$(this).val()},beforeSend:function(){1==++count_prop&&ere_result_by_title.html('<div class="processing-title"><i class="fa fa-spinner fa-spin fa-fw"></i></div>')},success:function(e){0==--count_prop&&(ere_result_by_title.show(),""!=e&&(ere_result_by_title.empty().html(e).bind(),ere_check_scroll_result_by_title(),ere_result_by_title.find("a.link-close").on("click",function(e){e.preventDefault(),ere_result_by_title.fadeOut()})))},error:function(xhr){0==--count_prop&&ere_result_by_title.html('<div class="processing-title"><i class="fa fa-spinner fa-spin fa-fw"></i></div>');var err=eval("("+xhr.responseText+")");console.log(err.Message)}})):auto_complete_container.fadeOut()}),auto_complete_container.on("click","li",function(){$('input[name="title"]').val($(this).data("text")),auto_complete_container.fadeOut()}).bind()};ere_title_auto_complete();var ere_map,markers=[],marker_cluster=null,googlemap_default_zoom=ere_search_vars.googlemap_default_zoom,not_found=ere_search_vars.not_found,clusterIcon=ere_search_vars.clusterIcon,initial_city=ere_search_vars.initial_city,google_map_style=ere_search_vars.google_map_style,pin_cluster_enable=ere_search_vars.pin_cluster_enable,drgflag=!0;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(drgflag=!1);var ere_search_map_option={zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_CENTER},scrollwheel:!1,scroll:{x:$(window).scrollLeft(),y:$(window).scrollTop()},zoom:parseInt(googlemap_default_zoom),mapTypeId:google.maps.MapTypeId.ROADMAP,draggable:drgflag,fullscreenControl:!0,fullscreenControlOptions:{position:google.maps.ControlPosition.RIGHT_CENTER}},infobox=new InfoBox({disableAutoPan:!0,maxWidth:310,alignBottom:!0,pixelOffset:new google.maps.Size(-140,-55),zIndex:null,closeBoxMargin:"0 0 -16px -16px",infoBoxClearance:new google.maps.Size(1,1),isHidden:!1,pane:"floatPane",enableEventPropagation:!1}),ere_add_markers=function(e,t){$.each(e,function(e,r){var a=new google.maps.LatLng(r.lat,r.lng),i={url:r.marker_icon,size:new google.maps.Size(44,60),scaledSize:new google.maps.Size(44,60),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(7,27)},n=new google.maps.Marker({position:a,map:t,icon:i,draggable:!1,animation:google.maps.Animation.DROP}),s=r.data?r.data.post_title:r.title,o="";""!=r.image_url&&void 0!==r.image_url||(o='style="display: none;"');var l=document.createElement("div");l.className="marker-content clearfix",l.innerHTML='<div class="marker-content-inner clearfix"><div class = "item-thumb" '+o+'><a href="'+r.url+'"><img src="'+r.image_url+'" alt="'+s+'" style="width: 100px;"></a></div><div class="item-body"><a href="'+r.url+'" class="title-marker">'+s+'</a><div class="price-marker">'+r.price+'</div><div class="address-marker"><i class="fa fa-map-marker"></i>'+r.address+"</div></div></div>",google.maps.event.addListener(n,"click",function(e,r){return function(){var r=100/Math.pow(2,t.getZoom())||0,a=t.getProjection(),i=e.getPosition(),n=a.fromLatLngToPoint(i),s=new google.maps.Point(n.x,n.y-r),o=a.fromPointToLatLng(s);t.setCenter(o),setTimeout(function(){infobox.setContent(l),infobox.open(t,e)},300)}}(n)),markers.push(n)})},ere_reload_markers=function(){for(var e=0;e<markers.length;e++)markers[e].setMap(null);markers=[]},ere_search_on_change=function(e,t){var r,a,i,n,s,o,l,c,d,_,p,u,m,f,h,g,v,y,b,x,w,k,j,E,C;s=e.find('input[name="title"]').val(),f=e.find('input[name="keyword"]').val(),a=e.find('select[name="city"]').val(),l=e.find('select[name="type"]').val(),void 0==(o=e.find('select[name="status"]').val())&&(o=e.find('input[name="status"]').val()),c=e.find('select[name="bedrooms"]').val(),d=e.find('select[name="bathrooms"]').val(),_=e.find(".ere-sliderbar-filter.ere-sliderbar-price").attr("data-min"),p=e.find(".ere-sliderbar-filter.ere-sliderbar-price").attr("data-max"),u=e.find(".ere-sliderbar-filter.ere-sliderbar-area").attr("data-min"),m=e.find(".ere-sliderbar-filter.ere-sliderbar-area").attr("data-max"),i=e.find('select[name="state"]').val(),r=e.find('select[name="country"]').val(),n=e.find('select[name="neighborhood"]').val(),"1"==e.find('input[name="advanced"]').val()&&(g=e.find(".ere-sliderbar-filter.ere-sliderbar-year-built").attr("data-min"),v=e.find(".ere-sliderbar-filter.ere-sliderbar-year-built").attr("data-max"),b=e.find('select[name="label"]').val(),h=e.find('select[name="garage"]').val(),x=e.find(".ere-sliderbar-filter.ere-sliderbar-garage-area").attr("data-min"),w=e.find(".ere-sliderbar-filter.ere-sliderbar-garage-area").attr("data-max"),k=e.find(".ere-sliderbar-filter.ere-sliderbar-land-area").attr("data-min"),j=e.find(".ere-sliderbar-filter.ere-sliderbar-land-area").attr("data-max"),E=e.find('input[name="property_identity"]').val(),"1"==e.find('input[name="featured-search"]').val()&&(y="",e.find(".featured-list input[type=checkbox]:checked").each(function(){y+=$(this).val()+";"}),""!=y&&(y=y.substring(0,y.length-1)))),C=t;var P="map_only";$(".list-property-result-ajax ").length>0&&(P="map_and_content"),ere_properties_search(s,f,r,i,a,n,l,o,c,d,_,p,u,m,g,v,b,h,x,w,k,j,E,y,C,P)},ere_properties_search=function(title,address_keyword,country,state,city,neighborhood,type,status,bedrooms,bathrooms,min_price,max_price,min_area,max_area,min_year,max_year,label,garage,min_garage_area,max_garage_area,min_land_area,max_land_area,property_identity,features,map_result,search_type){var ere_security_search_map=$("#ere_security_search_map").val(),map_result_content=$("#"+map_result);$.ajax({dataType:"json",url:ajax_url,data:{action:"ere_property_search_ajax",title:title,address_keyword:address_keyword,country:country,state:state,city:city,neighborhood:neighborhood,type:type,status:status,bedrooms:bedrooms,bathrooms:bathrooms,min_price:min_price,max_price:max_price,min_area:min_area,max_area:max_area,min_year:min_year,max_year:max_year,label:label,garage:garage,min_garage_area:min_garage_area,max_garage_area:max_garage_area,min_land_area:min_land_area,max_land_area:max_land_area,property_identity:property_identity,features:features,search_type:search_type,ere_security_search_map:ere_security_search_map},beforeSend:function(){map_result_content.parents("div.ere-search-properties").find("#ere-map-loading").fadeIn()},success:function(e){if("map_and_content"==search_type){var t=$(".owl-carousel",".list-property-result-ajax"),r=$(".list-property-result-ajax");if(t.empty(),!1===e.success)r.find(".title-result h2 .number-result").hide(),r.find(".title-result h2 .text-no-result").show(),r.find(".title-result h2 .text-result").hide();else{var a=$(".property-item",e.property_html);t.css("opacity",0),t.trigger("destroy.owl.carousel"),t.html(a),t.css("opacity",1),t.imagesLoaded(function(){ERE.set_item_effect(a,"hide"),ERE_Carousel.owlCarousel(),a=$(".property-item",t),ERE.set_item_effect(a,"show")}),"0"!=a.length&&(r.find(".title-result h2 .number-result").html(a.length),r.find(".title-result h2 .number-result").show(),r.find(".title-result h2 .text-no-result").hide(),r.find(".title-result h2 .text-result").show())}ERE.favorite(),ERE.tooltip(),ERE_Compare.register_event_compare()}if((ere_map=new google.maps.Map(document.getElementById(map_result),ere_search_map_option)).set("scrollwheel",!1),google.maps.event.trigger(ere_map,"resize"),!0===e.success&&e.properties)var i=e.properties.length;if(1==i)var n=google.maps.event.addListener(ere_map,"bounds_changed",function(e){this.setZoom(parseInt(googlemap_default_zoom)),google.maps.event.removeListener(n)});if(""!==google_map_style){var s=JSON.parse(google_map_style);ere_map.setOptions({styles:s})}var o=new google.maps.LatLng("","");ere_map.setCenter(o),ere_map.setZoom(parseInt(googlemap_default_zoom)),ere_remove_map_loader(ere_map),!0===e.success?(ere_reload_markers(),ere_add_markers(e.properties,ere_map),ere_map.fitBounds(markers.reduce(function(e,t){return e.extend(t.getPosition())},new google.maps.LatLngBounds)),google.maps.event.trigger(ere_map,"resize"),"1"==pin_cluster_enable&&(marker_cluster=new MarkerClusterer(ere_map,markers,{gridSize:60,styles:[{url:clusterIcon,width:48,height:48,textColor:"#fff"}]}))):map_result_content.empty().html('<div class="map-notfound">'+not_found+"</div>"),map_result_content.closest("div.ere-search-properties").find("#ere-map-loading").fadeOut("slow")},error:function(xhr){var err=eval("("+xhr.responseText+")");console.log(err.Message),map_result_content.closest("div.ere-search-properties").find("#ere-map-loading").fadeOut("slow")}})},ere_remove_map_loader=function(e){google.maps.event.addListener(e,"tilesloaded",function(){$("#ere-map-loading").fadeOut()})};$(".ere-search-properties").each(function(){var e=$(this),t=$(this).find(".ere-map-result").attr("id"),r="#"+t;$(".ere-search-status-tab .btn-status-filter",e).on("click",function(){$(this).parent().find("input").val($(this).data("value")),$(this).parent().find("button").removeClass("active"),$(this).addClass("active")}),$(r).length>0&&($('select[name="bedrooms"], select[name="bathrooms"],select[name="type"],select[name="status"],input[name="status"] , select[name="garage"], select[name="label"],input[name="keyword"],input[name="title"],input[name="property_identity"], select[name="city"], select[name="country"], select[name="state"], select[name="neighborhood"]',e).on("change",function(){var r=e.find(".search-properties-form");ere_search_on_change(r,t)}),$(".ere-search-status-tab .btn-status-filter",e).on("click",function(){var r=e.find(".search-properties-form");ere_search_on_change(r,t)}),$('input[name="other_feature"]',e).on("change",function(){var r=e.find(".search-properties-form");ere_search_on_change(r,t)}),ere_properties_search("","","","",initial_city,"","","","","","","","","","","","","","","","","","","",t,"map_only"))})}});